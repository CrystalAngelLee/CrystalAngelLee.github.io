"use strict";(self.webpackChunkcrystal_docs=self.webpackChunkcrystal_docs||[]).push([[6762],{4437:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>l,contentTitle:()=>a,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var t=r(5893),s=r(1151);const o={},a="Module Federation \u6a21\u5757\u8054\u90a6",i={id:"micro_frontends/module_federation",title:"Module Federation \u6a21\u5757\u8054\u90a6",description:"\u901a\u8fc7 \u6a21\u5757\u8054\u90a6 \u4e5f\u53ef\u4ee5\u5b9e\u73b0\u5fae\u524d\u7aef\u67b6\u6784",source:"@site/docs/micro_frontends/module_federation.md",sourceDirName:"micro_frontends",slug:"/micro_frontends/module_federation",permalink:"/docs/micro_frontends/module_federation",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Single Spa",permalink:"/docs/micro_frontends/single_spa"},next:{title:"MicroApp \u624b\u628a\u624b",permalink:"/docs/micro_frontends/microapp_usage"}},l={},c=[{value:"1. <strong>\u521b\u5efa\u5e94\u7528\u7ed3\u6784</strong>",id:"1-\u521b\u5efa\u5e94\u7528\u7ed3\u6784",level:3},{value:"2. <strong>\u5e94\u7528\u521d\u59cb\u5316</strong>",id:"2-\u5e94\u7528\u521d\u59cb\u5316",level:3},{value:"3. <strong>Module Federation</strong>",id:"3-module-federation",level:3},{value:"\u5171\u4eab\u6a21\u5757",id:"\u5171\u4eab\u6a21\u5757",level:2},{value:"\u5b9e\u73b0\u6a21\u5757\u5171\u4eab",id:"\u5b9e\u73b0\u6a21\u5757\u5171\u4eab",level:3},{value:"\u5171\u4eab\u6a21\u5757\u7248\u672c\u51b2\u7a81\u89e3\u51b3",id:"\u5171\u4eab\u6a21\u5757\u7248\u672c\u51b2\u7a81\u89e3\u51b3",level:3},{value:"\u5f00\u653e\u5b50\u5e94\u7528\u6302\u8f7d\u63a5\u53e3",id:"\u5f00\u653e\u5b50\u5e94\u7528\u6302\u8f7d\u63a5\u53e3",level:3},{value:"\u57fa\u4e8e\u6a21\u5757\u8054\u90a6\u7684\u5fae\u524d\u7aef\u5b9e\u73b0\u65b9\u6848",id:"\u57fa\u4e8e\u6a21\u5757\u8054\u90a6\u7684\u5fae\u524d\u7aef\u5b9e\u73b0\u65b9\u6848",level:2},{value:"\u5e94\u7528\u6848\u4f8b\u6982\u8ff0",id:"\u5e94\u7528\u6848\u4f8b\u6982\u8ff0",level:3},{value:"Marketing",id:"marketing",level:3},{value:"\u5e94\u7528\u521d\u59cb\u5316",id:"\u5e94\u7528\u521d\u59cb\u5316",level:4},{value:"\u521b\u5efa\u6302\u8f7d\u65b9\u6cd5",id:"\u521b\u5efa\u6302\u8f7d\u65b9\u6cd5",level:4},{value:"\u521b\u5efa\u8def\u7531",id:"\u521b\u5efa\u8def\u7531",level:4},{value:"Container",id:"container",level:3},{value:"\u5e94\u7528\u521d\u59cb\u5316",id:"\u5e94\u7528\u521d\u59cb\u5316-1",level:4},{value:"<strong>\u52a0\u8f7d</strong> Marketing",id:"\u52a0\u8f7d-marketing",level:4},{value:"\u5171\u4eab\u5e93\u8bbe\u7f6e",id:"\u5171\u4eab\u5e93\u8bbe\u7f6e",level:3},{value:"\u8def\u7531\u914d\u7f6e",id:"\u8def\u7531\u914d\u7f6e",level:3},{value:"<strong>\u6982\u8ff0</strong>",id:"\u6982\u8ff0",level:4},{value:"<strong>\u66f4\u65b0\u73b0\u6709\u8def\u7531\u914d\u7f6e</strong>",id:"\u66f4\u65b0\u73b0\u6709\u8def\u7531\u914d\u7f6e",level:4},{value:"\u5fae\u5e94\u7528\u548c\u5bb9\u5668\u5e94\u7528\u8def\u7531\u6c9f\u901a",id:"\u5fae\u5e94\u7528\u548c\u5bb9\u5668\u5e94\u7528\u8def\u7531\u6c9f\u901a",level:4},{value:"Marketing \u5e94\u7528\u672c\u5730\u8def\u7531\u8bbe\u7f6e",id:"marketing-\u5e94\u7528\u672c\u5730\u8def\u7531\u8bbe\u7f6e",level:4},{value:"Authentication",id:"authentication",level:3},{value:"\u5e94\u7528\u521d\u59cb\u5316",id:"\u5e94\u7528\u521d\u59cb\u5316-2",level:4},{value:"Container \u5e94\u7528\u52a0\u8f7d AuthApp",id:"container-\u5e94\u7528\u52a0\u8f7d-authapp",level:4},{value:"\u61d2\u52a0\u8f7d\u5fae\u5e94\u7528",id:"\u61d2\u52a0\u8f7d\u5fae\u5e94\u7528",level:3},{value:"\u767b\u5f55\u72b6\u6001",id:"\u767b\u5f55\u72b6\u6001",level:3},{value:"\u8bbe\u7f6e\u767b\u5f55\u72b6\u6001",id:"\u8bbe\u7f6e\u767b\u5f55\u72b6\u6001",level:4},{value:"\u767b\u5f55\u72b6\u6001\u5e94\u7528",id:"\u767b\u5f55\u72b6\u6001\u5e94\u7528",level:4},{value:"Dashboard",id:"dashboard",level:3},{value:"\u521d\u59cb\u5316",id:"\u521d\u59cb\u5316",level:4},{value:"Container \u5e94\u7528\u52a0\u8f7d Dashboard",id:"container-\u5e94\u7528\u52a0\u8f7d-dashboard",level:4},{value:"Dashboard \u8def\u7531\u4fdd\u62a4",id:"dashboard-\u8def\u7531\u4fdd\u62a4",level:4}];function d(n){const e={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,s.a)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h1,{id:"module-federation-\u6a21\u5757\u8054\u90a6",children:"Module Federation \u6a21\u5757\u8054\u90a6"}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"\u901a\u8fc7 \u6a21\u5757\u8054\u90a6 \u4e5f\u53ef\u4ee5\u5b9e\u73b0\u5fae\u524d\u7aef\u67b6\u6784"}),"\n"]}),"\n",(0,t.jsx)(e.h1,{id:"module-federation-\u6a21\u5757\u8054\u90a6-\u6982\u8ff0",children:"Module Federation \u6a21\u5757\u8054\u90a6 \u6982\u8ff0"}),"\n",(0,t.jsx)(e.p,{children:"Module Federation \u5373\u4e3a\u6a21\u5757\u8054\u90a6\uff0c\u662f Webpack 5 \u4e2d\u65b0\u589e\u7684\u4e00\u9879\u529f\u80fd\uff0c\u53ef\u4ee5\u5b9e\u73b0\u8de8\u5e94\u7528\u5171\u4eab\u6a21\u5757\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-tex",children:"\u6211\u4eec\u6709\u4e24\u4e2a\u5e94\u7528\uff1aA\u5e94\u7528\u548cB\u5e94\u7528\u3002\nA\u5e94\u7528\u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e2a\u65b9\u6cd5\uff1asayHelloFromA\nB\u5e94\u7528\u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e2a\u65b9\u6cd5\uff1asayHelloFromB\n\u6211\u4eec\u60f3\u8981\u5728A\u5e94\u7528\u4e2d\u8c03\u7528B\u5e94\u7528\u63d0\u4f9b\u7684\u65b9\u6cd5\uff0cB\u5e94\u7528\u8c03\u7528A\u5e94\u7528\u63d0\u4f9b\u7684\u65b9\u6cd5\u3010\u8de8\u5e94\u7528\u8c03\u7528\u65b9\u6cd5\u3011\n\u6211\u4eec\u53ef\u4ee5\u628a\u4e00\u4e2a\u5e94\u7528\u5f53\u505a\u4e00\u4e2a\u6a21\u5757\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u4e00\u4e2a\u5e94\u7528\u4e2d\u52a0\u8f7d\u53e6\u4e00\u4e2a\u5e94\u7528\u4e86\uff0c\u53ea\u8981\u6211\u4eec\u53ef\u4ee5\u5728\u4e00\u4e2a\u5e94\u7528\u4e2d\u52a0\u8f7d\u53e6\u4e00\u4e2a\u5e94\u7528\u6211\u4eec\u5c31\u53ef\u4ee5\u5b9e\u73b0\u5fae\u524d\u7aef\u67b6\u6784\n"})}),"\n",(0,t.jsx)(e.h1,{id:"\u5feb\u901f\u5f00\u59cb-demo",children:"\u5feb\u901f\u5f00\u59cb-demo"}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"\u9700\u6c42\uff1a\u901a\u8fc7\u6a21\u5757\u8054\u90a6\u5728\u5bb9\u5668\u5e94\u7528\u4e2d\u52a0\u8f7d\u5fae\u5e94\u7528"}),"\n"]}),"\n",(0,t.jsxs)(e.h3,{id:"1-\u521b\u5efa\u5e94\u7528\u7ed3\u6784",children:["1. ",(0,t.jsx)(e.strong,{children:"\u521b\u5efa\u5e94\u7528\u7ed3\u6784"})]}),"\n",(0,t.jsxs)(e.p,{children:["\u6309\u7167\u4ee5\u4e0b\u76ee\u5f55\u7ed3\u6784\u6784\u5efa\u597d\u4e09\u4e2a\u5fae\u5e94\u7528\u7684\u5e94\u7528\u7ed3\u6784\uff0c",(0,t.jsx)(e.code,{children:"package.json"})," \u548c ",(0,t.jsx)(e.code,{children:"package-lock.json"})," \u6587\u4ef6\u521d\u59cb\u4f53\u9a8c\u53ef\u4ee5\u76f4\u63a5 copy \u5b8c\u6210demo \u4e2d\u7684\u6587\u4ef6\nhtml \u4e2d\u521d\u59cb\u5316\u597d\u5404\u81ea\u7684\u5185\u5bb9\n\u5b89\u88c5\u5404\u81ea\u7684\u4f9d\u8d56"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"products\n\u251c\u2500\u2500 package-lock.json\n\u251c\u2500\u2500 package.json\n\u251c\u2500\u2500 public       // \u9759\u6001\u8d44\u6e90\u6587\u4ef6\n\u2502   \u2514\u2500\u2500 index.html\n\u251c\u2500\u2500 src          // \u6e90\u7801\n\u2502   \u2514\u2500\u2500 index.js\n\u2514\u2500\u2500 webpack.config.js\n"})}),"\n",(0,t.jsxs)(e.h3,{id:"2-\u5e94\u7528\u521d\u59cb\u5316",children:["2. ",(0,t.jsx)(e.strong,{children:"\u5e94\u7528\u521d\u59cb\u5316"})]}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"\u5728\u5165\u53e3 JavaScript \u6587\u4ef6\u4e2d\u52a0\u5165\u4ea7\u54c1\u5217\u8868"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:"// faker \u53ef\u4ee5\u7528\u6765\u968f\u673a\u751f\u6210\u6570\u636e\nimport faker from 'faker'\n\nlet products = '';\n\nfor (let i = 1; i <= 5; i++) {\n    products += `<div>${faker.commerce.productName()}</div>`\n}\n\ndocument.querySelector(\"#products\").innerHTML = products\n"})}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"\u5728\u5165\u53e3 html \u6587\u4ef6\u4e2d\u52a0\u5165\u76d2\u5b50"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-html",children:'<div id="products"></div>\n'})}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"webpack \u914d\u7f6e"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'const HtmlWebpackPlugin = require("html-webpack-plugin")\n\nmodule.exports = {\n    mode: "development",\n    devServer: {\n        port: 8081\n    },\n    plugins: [\n        new HtmlWebpackPlugin({\n            template: "./public/index.html"\n        })\n    ]\n}\n'})}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"\u6dfb\u52a0\u5e94\u7528\u542f\u52a8\u547d\u4ee4"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-json",children:'"scripts": {\n    "start": "webpack serve"\n},\n'})}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"\u901a\u8fc7 copy \u7684\u65b9\u5f0f\u521b\u5efa container \u548c cart"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.h3,{id:"3-module-federation",children:["3. ",(0,t.jsx)(e.strong,{children:"Module Federation"})]}),"\n",(0,t.jsx)(e.p,{children:"\u901a\u8fc7\u914d\u7f6e\u6a21\u5757\u8054\u90a6\u5b9e\u73b0\u5728\u5bb9\u5668\u5e94\u7528\u4e2d\u52a0\u8f7d\u4ea7\u54c1\u5217\u8868\u5fae\u5e94\u7528\u3002"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"\u5728\u4ea7\u54c1\u5217\u8868\u5fae\u5e94\u7528\u4e2d\u5c06\u81ea\u8eab\u4f5c\u4e3a\u6a21\u5757\u8fdb\u884c\u5bfc\u51fa"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'// webpack.config.js\n// \u5bfc\u5165\u6a21\u5757\u8054\u90a6\u63d2\u4ef6\nconst ModuleFederationPlugin = require("webpack/lib/container/ModuleFederationPlugin");\n// \u5c06 products \u81ea\u8eab\u5f53\u505a\u6a21\u5757\u66b4\u9732\u51fa\u53bb\nnew ModuleFederationPlugin({\n  // \u6a21\u5757\u6587\u4ef6\u540d\u79f0, \u5176\u4ed6\u5e94\u7528\u5f15\u5165\u5f53\u524d\u6a21\u5757\u65f6\u9700\u8981\u52a0\u8f7d\u7684\u6587\u4ef6\u7684\u540d\u5b57\n  filename: "remoteEntry.js",\n  // \u6a21\u5757\u540d\u79f0, \u5177\u6709\u552f\u4e00\u6027, \u76f8\u5f53\u4e8e single-spa \u4e2d\u7684\u7ec4\u7ec7\u540d\u79f0\n  name: "products",\n  // \u5f53\u524d\u6a21\u5757\u5177\u4f53\u5bfc\u51fa\u7684\u5185\u5bb9\n  exposes: { "./index": "./src/index" },\n});\n// \u5728\u5bb9\u5668\u5e94\u7528\u4e2d\u8981\u5982\u4f55\u5f15\u5165\u4ea7\u54c1\u5217\u8868\u5e94\u7528\u6a21\u5757?\n// 1. \u5728\u5bb9\u5668\u5e94\u7528\u4e2d\u52a0\u8f7d\u4ea7\u54c1\u5217\u8868\u5e94\u7528\u7684\u6a21\u5757\u6587\u4ef6\n// 2. \u5728\u5bb9\u5668\u5e94\u7528\u4e2d\u901a\u8fc7 import \u5173\u952e\u5b57\u4ece\u6a21\u5757\u6587\u4ef6\u4e2d\u5bfc\u5165\u4ea7\u54c1\u5217\u8868\u5e94\u7528\u6a21\u5757\n'})}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"\u5728\u5bb9\u5668\u5e94\u7528\u7684\u4e2d\u5bfc\u5165\u4ea7\u54c1\u5217\u8868\u5fae\u5e94\u7528"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'// webpack.config.js\n// \u5bfc\u5165\u6a21\u5757\u8054\u90a6\u63d2\u4ef6\nconst ModuleFederationPlugin = require("webpack/lib/container/ModuleFederationPlugin");\nnew ModuleFederationPlugin({\n  name: "container",\n  // \u914d\u7f6e\u5bfc\u5165\u6a21\u5757\u6620\u5c04\n  remotes: {\n    // \u5b57\u7b26\u4e32 "products" \u548c\u88ab\u5bfc\u5165\u6a21\u5757\u7684 name \u5c5e\u6027\u503c\u5bf9\u5e94\n    // \u5c5e\u6027 products \u662f\u6620\u5c04\u522b\u540d, \u662f\u5728\u5f53\u524d\u5e94\u7528\u4e2d\u5bfc\u5165\u8be5\u6a21\u5757\u65f6\u4f7f\u7528\u7684\u540d\u5b57\n    products: "products@http://localhost:8081/remoteEntry.js",\n  },\n});\n'})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'// src/index.js \n// \u56e0\u4e3a\u662f\u4ece\u53e6\u4e00\u4e2a\u5e94\u7528\u4e2d\u52a0\u8f7d\u6a21\u5757, \u8981\u53d1\u9001\u8bf7\u6c42\u6240\u4ee5\u4f7f\u7528\u5f02\u6b65\u52a0\u8f7d\u65b9\u5f0f \nimport("products/index").then(products => console.log(products))\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u901a\u8fc7\u4e0a\u9762\u8fd9\u79cd\u65b9\u5f0f\u52a0\u8f7d\u5728\u5199\u6cd5\u4e0a\u591a\u4e86\u4e00\u5c42\u56de\u8c03\u51fd\u6570, \u4e0d\u662f\u5f88\u65b9\u4fbf, \u6240\u4ee5\u4e00\u822c\u90fd\u4f1a\u5728 src \u6587\u4ef6\u5939\u4e2d\u5efa\u7acbbootstrap.js\uff0c\u5728\u5f62\u5f0f\u4e0a\u5c06\u5199\u6cd5\u53d8\u4e3a\u540c\u6b65"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:"// src/index.js \nimport('./bootstrap.js') \n\n// src/bootstrap.js \nimport \"products/index\"\n"})}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["\u5b9e\u73b0 Cart \u5fae\u5e94\u7528\u52a0\u8f7d\n\u6ce8\u610f",":cart","/index.html \u548c products/index.html \u4ec5\u4ec5\u662f\u5728\u5f00\u53d1\u9636\u6bb5\u4e2d\u5404\u81ea\u56e2\u961f\u4f7f\u7528\u7684\u6587\u4ef6\uff0c\u800c container/index.html \u662f\u5728\u5f00\u53d1\u9636\u6bb5\u548c\u751f\u4ea7\u9636\u6bb5\u90fd\u8981\u4f7f\u7528\u7684\u6587\u4ef6\u3002"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"\u5171\u4eab\u6a21\u5757",children:"\u5171\u4eab\u6a21\u5757"}),"\n",(0,t.jsx)(e.h3,{id:"\u5b9e\u73b0\u6a21\u5757\u5171\u4eab",children:"\u5b9e\u73b0\u6a21\u5757\u5171\u4eab"}),"\n",(0,t.jsx)(e.p,{children:"\u5728 Products \u548c Cart \u4e2d\u90fd\u9700\u8981 Faker\uff0c\u5f53 Container \u52a0\u8f7d\u4e86\u8fd9\u4e24\u4e2a\u6a21\u5757\u540e\uff0cFaker \u88ab\u52a0\u8f7d\u4e86\u4e24\u6b21\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'// \u5206\u522b\u5728 Products \u548c Cart \u7684 webpack \u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u6a21\u5757\u8054\u90a6\u63d2\u4ef6\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u4ee3\u7801 \n// \u5982\u679c\u9047\u5230\u7248\u672c\u4e0d\u4e00\u81f4\u7684\u95ee\u9898\uff0c\u5f3a\u5236\u4f7f\u7528\u9ad8\u7248\u672c\n{\n  shared: ["faker"]\n}\n// \u91cd\u65b0\u542f\u52a8 Container\u3001Products\u3001Cart\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u6ce8\u610f:\u5171\u4eab\u6a21\u5757\u9700\u8981\u5f02\u6b65\u52a0\u8f7d\uff0c\u5728 Products \u548c Cart \u4e2d\u9700\u8981\u6dfb\u52a0 bootstrap.js"}),"\n",(0,t.jsx)(e.h3,{id:"\u5171\u4eab\u6a21\u5757\u7248\u672c\u51b2\u7a81\u89e3\u51b3",children:"\u5171\u4eab\u6a21\u5757\u7248\u672c\u51b2\u7a81\u89e3\u51b3"}),"\n",(0,t.jsx)(e.p,{children:"Cart \u4e2d\u5982\u679c\u4f7f\u7528 4.1.0 \u7248\u672c\u7684 faker\uff0cProducts \u4e2d\u4f7f\u7528 5.2.0 \u7248\u672c\u7684 faker\uff0c\u901a\u8fc7\u67e5\u770b\u7f51\u7edc\u63a7\u5236\u9762\u677f\u53ef\u4ee5\u53d1\u73b0 faker \u53c8\u4f1a\u88ab\u52a0\u8f7d\u4e86\u4e24\u6b21\uff0c\u6a21\u5757\u5171\u4eab\u5931\u8d25\u3002\n\u89e3\u51b3\u529e\u6cd5\u662f\u5206\u522b\u5728 Products \u548c Cart \u4e2d\u7684 webpack \u914d\u7f6e\u4e2d\u52a0\u5165\u5982\u4e0b\u4ee3\u7801"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:"shared: {\n  faker: {\n    singleton: true\n  }\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u4f46\u540c\u65f6\u4f1a\u5728\u539f\u672c\u4f7f\u7528\u4f4e\u7248\u672c\u7684\u5171\u4eab\u6a21\u5757\u5e94\u7528\u7684\u63a7\u5236\u53f0\u4e2d\u7ed9\u4e88\u8b66\u544a\u63d0\u793a\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u5f00\u653e\u5b50\u5e94\u7528\u6302\u8f7d\u63a5\u53e3",children:"\u5f00\u653e\u5b50\u5e94\u7528\u6302\u8f7d\u63a5\u53e3"}),"\n",(0,t.jsx)(e.p,{children:"\u5728\u5bb9\u5668\u5e94\u7528\u5bfc\u5165\u5fae\u5e94\u7528\u540e\uff0c\u5e94\u8be5\u6709\u6743\u9650\u51b3\u5b9a\u5fae\u5e94\u7528\u7684\u6302\u8f7d\u4f4d\u7f6e\uff0c\u800c\u4e0d\u662f\u5fae\u5e94\u7528\u5728\u4ee3\u7801\u8fd0\u884c\u65f6\u76f4\u63a5\u8fdb\u884c\u6302 \u8f7d\u3002\u6240\u4ee5\u6bcf\u4e2a\u5fae\u5e94\u7528\u90fd\u5e94\u8be5\u5bfc\u51fa\u4e00\u4e2a\u6302\u8f7d\u65b9\u6cd5\u4f9b\u5bb9\u5668\u5e94\u7528\u8c03\u7528\u3002"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.a,{href:"https://github.com/CrystalAngelLee/crystal-micro-frontend/tree/main/products/src",children:"Products/bootstrap.js"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'// faker \u53ef\u4ee5\u7528\u6765\u968f\u673a\u751f\u6210\u6570\u636e\nimport faker from "faker";\n\nfunction mount(el) {\n  let products = "";\n\n  for (let i = 1; i <= 5; i++) {\n    products += `<div>${faker.commerce.productName()}</div>`;\n  }\n\n  el.innerHTML = products;\n}\n\n// \u6b64\u5904\u4ee3\u7801\u662f products \u5e94\u7528\u5728\u672c\u5730\u5f00\u53d1\u73af\u5883\u4e0b\u6267\u884c\u7684\nif (process.env.NODE_ENV === "development") {\n  const el = document.querySelector("#dev-products");\n  // \u5f53\u5bb9\u5668\u5e94\u7528\u5728\u672c\u5730\u5f00\u53d1\u73af\u5883\u4e0b\u6267\u884c\u65f6\u4e5f\u53ef\u4ee5\u8fdb\u5165\u5230\u4ee5\u4e0a\u8fd9\u4e2a\u5224\u65ad, \u5bb9\u5668\u5e94\u7528\u5728\u6267\u884c\u5f53\u524d\u4ee3\u7801\u65f6\u80af\u5b9a\u662f\u83b7 \u53d6\u4e0d\u5230 dev-products \u5143\u7d20\u7684, \u6240\u4ee5\u6b64\u5904\u8fd8\u9700\u8981\u5bf9 el \u8fdb\u884c\u5224\u65ad.\n  if (el) mount(el);\n}\nexport { mount };\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.a,{href:"https://github.com/CrystalAngelLee/crystal-micro-frontend/blob/main/products/webpack.config.js",children:"Products/webpack.config.js"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'exposes: {\n  // ./src/index => ./src/bootstrap \u4e3a\u4ec0\u4e48 ?\n  // mount \u65b9\u6cd5\u662f\u5728 bootstrap.js \u6587\u4ef6\u4e2d\u5bfc\u51fa\u7684, \u6240\u4ee5\u6b64\u5904\u8981\u5bfc\u51fa bootstrap\n  // \u6b64\u5904\u7684\u5bfc\u51fa\u662f\u7ed9\u5bb9\u5668\u5e94\u7528\u4f7f\u7528\u7684, \u548c\u5f53\u524d\u5e94\u7528\u7684\u6267\u884c\u6ca1\u6709\u5173\u7cfb, \u5f53\u524d\u5e94\u7528\u5728\u6267\u884c\u65f6\u4f9d\u7136\u5148\u6267\u884c index\n  "./Index": "./src/bootstrap",\n},\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.a,{href:"https://github.com/CrystalAngelLee/crystal-micro-frontend/tree/main/fedcontainer",children:"Container/bootstrap.js"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'import { mount as mountProducts } from "products/Index";\nmountProducts(document.querySelector("dev-products"));\n'})}),"\n",(0,t.jsx)(e.h2,{id:"\u57fa\u4e8e\u6a21\u5757\u8054\u90a6\u7684\u5fae\u524d\u7aef\u5b9e\u73b0\u65b9\u6848",children:"\u57fa\u4e8e\u6a21\u5757\u8054\u90a6\u7684\u5fae\u524d\u7aef\u5b9e\u73b0\u65b9\u6848"}),"\n",(0,t.jsx)(e.h3,{id:"\u5e94\u7528\u6848\u4f8b\u6982\u8ff0",children:"\u5e94\u7528\u6848\u4f8b\u6982\u8ff0"}),"\n",(0,t.jsx)(e.p,{children:"\u5f53\u524d\u6848\u4f8b\u4e2d\u5305\u542b\u4e09\u4e2a\u5fae\u5e94\u7528\uff0c\u5206\u522b\u4e3a Marketing\u3001Authentication \u548c Dashboard"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"Marketing: \u8425\u9500\u5fae\u5e94\u7528\uff0c\u5305\u542b\u9996\u9875\u7ec4\u4ef6\u548c\u4ef7\u683c\u7ec4\u4ef6"}),"\n",(0,t.jsx)(e.li,{children:"Authentication:\u8eab\u4efd\u9a8c\u8bc1\u5fae\u5e94\u7528\uff0c\u5305\u542b\u767b\u5f55\u7ec4\u4ef6"}),"\n",(0,t.jsx)(e.li,{children:"Dashboard:\u4eea\u8868\u76d8\u5fae\u5e94\u7528\uff0c\u5305\u542b\u4eea\u8868\u76d8\u7ec4\u4ef6"}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:"\u5bb9\u5668\u5e94\u7528\u3001\u8425\u9500\u5e94\u7528\u3001\u8eab\u4efd\u9a8c\u8bc1\u5e94\u7528\u4f7f\u7528 React \u6846\u67b6\uff0c\u4eea\u8868\u76d8\u5e94\u7528\u4f7f\u7528 Vue \u6846\u67b6\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"marketing",children:"Marketing"}),"\n",(0,t.jsx)(e.h4,{id:"\u5e94\u7528\u521d\u59cb\u5316",children:"\u5e94\u7528\u521d\u59cb\u5316"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"1. \u521b\u5efa\u5e94\u7528\u7ed3\u6784"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-tex",children:"\u251c\u2500\u2500 public\n\u2502 \u2514\u2500\u2500 index.html \n\u251c\u2500\u2500 src\n\u2502 \u251c\u2500\u2500 bootstrap.js\n\u2502 \u2514\u2500\u2500 index.js\n\u251c\u2500\u2500 package-lock.json\n\u251c\u2500\u2500 package.json\n\u2514\u2500\u2500 webpack.config.js\n"})}),"\n",(0,t.jsx)(e.p,{children:"index.html"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-html",children:'<title>Marketing</title>\n<div id="dev-marketing"></div>\n'})}),"\n",(0,t.jsx)(e.p,{children:"index.js"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'import("./bootstrap")\n'})}),"\n",(0,t.jsx)(e.p,{children:"bootstrap.js"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:"console.log('\u6d4b\u8bd5\u7528\u4f8b')\n"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"2. \u914d\u7f6e webpack"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'const HtmlWebpackPlugin = require("html-webpack-plugin")\n\nmodule.exports = {\n  mode: "development",\n  devServer: {\n    port: 8081,\n    // \u5f53\u4f7f\u7528 HTML5 History API \u65f6, \u6240\u6709\u7684 404 \u8bf7\u6c42\u90fd\u4f1a\u54cd\u5e94 index.html \u6587\u4ef6\n    historyApiFallback: true\n  },\n  module: {\n    rules: [\n      {\n        test: /\\.js$/,\n        exclude: /node_modules/,\n        use: {\n          loader: "babel-loader",\n          options: {\n            presets: ["@babel/preset-react", "@babel/preset-env"],\n            // 1. \u907f\u514d babel \u8f6c\u4e49\u8bed\u6cd5\u540e helper \u51fd\u6570\u91cd\u590d\n\t\t\t\t\t\t// 2. \u907f\u514d babel polyfill \u5c06 API \u6dfb\u52a0\u5230\u5168\u5c40\n            plugins: ["@babel/plugin-transform-runtime"]\n          }\n        }\n      }\n    ]\n  },\n  plugins: [\n    new HtmlWebpackPlugin({\n      template: "./public/index.html"\n    })\n  ]\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"3. \u6dfb\u52a0\u542f\u52a8\u547d\u4ee4"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'"scripts": {\n  "start": "webpack serve"\n}\n'})}),"\n",(0,t.jsx)(e.h4,{id:"\u521b\u5efa\u6302\u8f7d\u65b9\u6cd5",children:"\u521b\u5efa\u6302\u8f7d\u65b9\u6cd5"}),"\n",(0,t.jsx)(e.p,{children:"bootstrap.js"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'import React from "react"\nimport ReactDOM from "react-dom"\n\nfunction mount(el) {\n  ReactDOM.render(<div>test</div>, el)\n}\n\nif (process.env.NODE_ENV === "development") {\n  const el = document.querySelector("#dev-marketing")\n  if (el) mount(el)\n}\n\nexport { mount }\n'})}),"\n",(0,t.jsx)(e.h4,{id:"\u521b\u5efa\u8def\u7531",children:"\u521b\u5efa\u8def\u7531"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"\u5728 src \u6587\u4ef6\u5939\u4e2d\u521b\u5efa components \u6587\u4ef6\u5939\u7528\u4e8e\u653e\u7f6e\u9875\u9762\u7ec4\u4ef6"}),"\n",(0,t.jsx)(e.li,{children:"\u5728 src \u6587\u4ef6\u5939\u4e2d\u521b\u5efa App \u7ec4\u4ef6\uff0c\u7528\u4e8e\u7f16\u5199\u8def\u7531"}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:"App.js"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'import React from "react"\nimport { BrowserRouter, Route, Switch } from "react-router-dom"\nimport Landing from "./components/Landing"\nimport Pricing from "./components/Pricing"\n\nfunction App() {\n  return (\n    <BrowserRouter>\n      <Switch>\n        <Route path="/pricing">\n          <Pricing />\n        </Route>\n        <Route path="/">\n          <Landing />\n        </Route>\n      </Switch>\n    </BrowserRouter>\n  )\n}\n\nexport default App\n'})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'// bootstrap.js\nimport App from "./App"\nfunction mount(el) { \n  ReactDOM.render(<App />, el)\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"container",children:"Container"}),"\n",(0,t.jsx)(e.h4,{id:"\u5e94\u7528\u521d\u59cb\u5316-1",children:"\u5e94\u7528\u521d\u59cb\u5316"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"1. \u521b\u5efa\u5e94\u7528\u7ed3\u6784 (\u57fa\u4e8e Marketing \u5e94\u7528\u8fdb\u884c\u62f7\u8d1d\u4fee\u6539)"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-tex",children:"\u251c\u2500\u2500 public\n\u2502 \u2514\u2500\u2500 index.html \n\u251c\u2500\u2500 src\n\u2502 \u251c\u2500\u2500 bootstrap.js\n\u2502 \u2514\u2500\u2500 index.js\n\u251c\u2500\u2500 package-lock.json\n\u251c\u2500\u2500 package.json\n\u2514\u2500\u2500 webpack.config.js\n"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"2. \u4fee\u6539 index.html"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-html",children:'<title>Container</title>\n<div id="root"></div>\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"3. \u4fee\u6539 App.js"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'import React from "react"\nexport default function App() {\n  return <div>Container works</div>\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"4. \u4fee\u6539 bootstrap.js"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'if (process.env.NODE_ENV === "development") { \n  const el = document.querySelector("#root") \n\tif (el) mount(el)\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"5. \u4fee\u6539 webpack.config.js"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:"module.exports = { \n  devServer: {\n\t\tport: 8080 \n  }\n}\n"})}),"\n",(0,t.jsxs)(e.h4,{id:"\u52a0\u8f7d-marketing",children:[(0,t.jsx)(e.strong,{children:"\u52a0\u8f7d"})," Marketing"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"1. Marketing \u5e94\u7528\u914d\u7f6e ModuleFederation"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'const ModuleFederationPlugin = require("webpack/lib/container/ModuleFederationPlugin")\nnew ModuleFederationPlugin({ \n  name: "marketing", \n  filename: "remoteEntry.js", \n  exposes: {\n\t\t"./MarketingApp": "./src/bootstrap" \n  }\n})\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"2. Container \u5e94\u7528\u914d\u7f6e ModuleFederation"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'const ModuleFederationPlugin =\nrequire("webpack/lib/container/ModuleFederationPlugin")\nnew ModuleFederationPlugin({\n  name: "container",\n  remotes: {\n\t\tmarketing: "marketing@http://localhost:8081/remoteEntry.js" \n  }\n})\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"3. \u5728 Container \u5e94\u7528\u4e2d\u65b0\u5efa MarketingApp \u7ec4\u4ef6\uff0c\u7528\u4e8e\u6302\u8f7d Marketing \u5e94\u7528"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'// Container/components/MarketingApp.js\nimport React, { useRef, useEffect } from "react"\nimport { mount } from "marketing/MarketingApp"\nexport default function MarketingApp() {\n  const ref = useRef()\n  useEffect(() => {\n\t\tmount(ref.current) \n  }, [])\n  return <div ref={ref}></div>\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"4. \u5728 Container \u5e94\u7528\u4e2d\u7684 App \u7ec4\u4ef6\u4e2d\u6e32\u67d3 Marketing \u5e94\u7528\u7684"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'// Container/App.js\nimport React from "react"\nimport MarketingApp from "./components/MarketingApp"\nexport default function App() {\n  return <MarketingApp />\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"\u5171\u4eab\u5e93\u8bbe\u7f6e",children:"\u5171\u4eab\u5e93\u8bbe\u7f6e"}),"\n",(0,t.jsx)(e.p,{children:"\u5728 Container \u5e94\u7528\u548c Marketing \u5e94\u7528\u4e2d\u90fd\u4f7f\u7528\u4e86\u5927\u91cf\u7684\u76f8\u540c\u7684\u4ee3\u7801\u5e93\uff0c\u5982\u679c\u4e0d\u505a\u5171\u4eab\u5904\u7406\uff0c\u5219\u5e94\u7528\u4e2d\u76f8\u540c\u7684\u5171\u4eab\u5e93\u4f1a\u88ab\u52a0\u8f7d\u4e24\u6b21\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-json",children:'"dependencies": { \n  "@material-ui/core": "^4.11.0", \n  "@material-ui/icons": "^4.9.1", \n  "react": "^17.0.1", \n  "react-dom": "^17.0.1", \n  "react-router-dom": "^5.2.0"\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u5728 Container \u5e94\u7528\u548c Marketing \u5e94\u7528\u7684 webpack \u914d\u7f6e\u6587\u4ef6\u4e2d\u52a0\u5165\u4ee5\u4e0b\u4ee3\u7801"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'const packageJson = require("./package.json")\nnew ModuleFederationPlugin({ \n  shared: packageJson.dependencies\n})\n'})}),"\n",(0,t.jsx)(e.h3,{id:"\u8def\u7531\u914d\u7f6e",children:"\u8def\u7531\u914d\u7f6e"}),"\n",(0,t.jsx)(e.h4,{id:"\u6982\u8ff0",children:(0,t.jsx)(e.strong,{children:"\u6982\u8ff0"})}),"\n",(0,t.jsx)(e.p,{children:"\u5bb9\u5668\u5e94\u7528\u8def\u7531\u7528\u4e8e\u5339\u914d\u5fae\u5e94\u7528\uff0c\u5fae\u5e94\u7528\u8def\u7531\u7528\u4e8e\u5339\u914d\u7ec4\u4ef6\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u5bb9\u5668\u5e94\u7528\u4f7f\u7528 BrowserHistory \u8def\u7531\uff0c\u5fae\u5e94\u7528\u4f7f\u7528 MemoryHistory \u8def\u7531\u3002"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"\u4e3a\u9632\u6b62\u5bb9\u5668\u5e94\u7528\u548c\u5fae\u5e94\u7528\u540c\u65f6\u64cd\u4f5c url \u800c\u4ea7\u751f\u51b2\u7a81\uff0c\u5728\u5fae\u524d\u7aef\u67b6\u6784\u4e2d\uff0c\u53ea\u5141\u8bb8\u5bb9\u5668\u5e94\u7528\u66f4\u65b0 url\uff0c \u5fae\u5e94\u7528\u4e0d\u5141\u8bb8\u66f4\u65b0 url\uff0cMemoryHistory \u662f\u57fa\u4e8e\u5185\u5b58\u7684\u8def\u7531\uff0c\u4e0d\u4f1a\u6539\u53d8\u6d4f\u89c8\u5668\u5730\u5740\u680f\u4e2d\u7684 url\u3002"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"\u5982\u679c\u4e0d\u540c\u7684\u5e94\u7528\u7a0b\u5e8f\u9700\u8981\u4f20\u8fbe\u6709\u5173\u8def\u7531\u7684\u76f8\u5173\u4fe1\u606f\uff0c\u5e94\u8be5\u5c3d\u53ef\u80fd\u7684\u4f7f\u7528\u901a\u8fc7\u7684\u65b9\u5f0f\uff0c memoryHistory \u5728 React \u548c Vue \u4e2d\u90fd\u6709\u63d0\u4f9b\u3002"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.h4,{id:"\u66f4\u65b0\u73b0\u6709\u8def\u7531\u914d\u7f6e",children:(0,t.jsx)(e.strong,{children:"\u66f4\u65b0\u73b0\u6709\u8def\u7531\u914d\u7f6e"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"1. \u5bb9\u5668\u5e94\u7528\u7684\u8def\u7531\u914d\u7f6e"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'// Container/App.js\nimport { Router, Route, Switch } from "react-router-dom" \nimport { createBrowserHistory } from "history"\nconst history = createBrowserHistory()\nexport default function App() {\n  return (\n    <Router history={history}>\n      <Switch>\n        <Route path="/">\n          <MarketingApp />\n        </Route>\n      </Switch>\n\t\t</Router>\n) }\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"2. Marketing \u5e94\u7528\u7684\u8def\u7531\u914d\u7f6e"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'// Marketing/bootstrap.js\nimport { createMemoryHistory } from "history"\nfunction mount(el) {\n  const history = createMemoryHistory() \n  ReactDOM.render(<App history={history} />, el)\n}\n'})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'// Marketing/app.js\nimport { Router, Route, Switch } from "react-router-dom"\nexport default function App({ history }) {\n  return (\n    <Router history={history}>\n      <Switch>\n        <Route path="/pricing" component={Pricing} />\n        <Route path="/" component={Landing} />\n      </Switch>\n\t\t</Router>\n) }\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"3. \u6dfb\u52a0\u5934\u90e8\u7ec4\u4ef6"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'import Header from "./components/Header"\nexport default function App() {\n  return <Header />\n}\n'})}),"\n",(0,t.jsx)(e.h4,{id:"\u5fae\u5e94\u7528\u548c\u5bb9\u5668\u5e94\u7528\u8def\u7531\u6c9f\u901a",children:"\u5fae\u5e94\u7528\u548c\u5bb9\u5668\u5e94\u7528\u8def\u7531\u6c9f\u901a"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"\u5fae\u5e94\u7528\u8def\u7531\u53d8\u5316\u65f6 url \u5730\u5740\u6ca1\u6709\u88ab\u540c\u6b65\u5230\u6d4f\u89c8\u5668\u7684\u5730\u5740\u680f\u4e2d\uff0c\u8def\u7531\u53d8\u5316\u4e5f\u6ca1\u6709\u88ab\u540c\u6b65\u5230\u6d4f\u89c8\u5668\u7684\u5386\u53f2\u8bb0\u5f55\u4e2d\u3002\n\u5f53\u5fae\u5e94\u7528\u8def\u7531\u53d1\u751f\u53d8\u5316\u65f6\u901a\u77e5\u5bb9\u5668\u5e94\u7528\u66f4\u65b0\u8def\u7531\u4fe1\u606f (\u5bb9\u5668\u5e94\u7528\u5411\u5fae\u5e94\u7528\u4f20\u9012\u65b9\u6cd5)\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'// Container/components/MarketingApp.js\nimport { useHistory } from "react-router-dom"\nconst history = useHistory()\nmount(ref.current, {\n  onNavigate({ pathname: nextPathname }) {\n    const { pathname } = history.location \n    if (pathname !== nextPathname) {\n      history.push(nextPathname) \n    }\n  } \n})\n'})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:"// Marketing/bootstrap.js\nfunction mount(el, { onNavigate }) {\n\tif (onNavigate) history.listen(onNavigate)\n}\n"})}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"\u5bb9\u5668\u5e94\u7528\u8def\u7531\u53d1\u751f\u53d8\u5316\u65f6\u53ea\u80fd\u5339\u914d\u5230\u5fae\u5e94\u7528\uff0c\u5fae\u5e94\u7528\u8def\u7531\u5e76\u4e0d\u4f1a\u54cd\u5e94\u5bb9\u5668\u5e94\u7528\u8def\u7531\u7684\u53d8\u5316\u3002 \u5f53\u5bb9\u5668\u5e94\u7528\u8def\u7531\u53d1\u751f\u53d8\u5316\u65f6\u9700\u8981\u901a\u77e5\u5fae\u5e94\u7528\u8def\u7531\u8fdb\u884c\u54cd\u5e94 (\u5fae\u5e94\u7528\u5411\u5bb9\u5668\u5e94\u7528\u4f20\u9012\u65b9\u6cd5)"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:"// Marketing/bootstrap.js\nfunction mount(el, { onNavigate }) {\n  return {\n    onParentNavigate({ pathname: nextPathname }) {\n      const pathname = history.location.pathname;\n      if (nextPathname !== pathname) {\n        history.push(nextPathname);\n      }\n    },\n  };\n}\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:"// Container/components/MarketingApp.js\nconst { onParentNavigate } = mount(...)\nif (onParentNavigate) history.listen(onParentNavigate);\n"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.h4,{id:"marketing-\u5e94\u7528\u672c\u5730\u8def\u7531\u8bbe\u7f6e",children:"Marketing \u5e94\u7528\u672c\u5730\u8def\u7531\u8bbe\u7f6e"}),"\n",(0,t.jsx)(e.p,{children:"\u76ee\u524d Marketing \u5e94\u7528\u672c\u5730\u5f00\u53d1\u73af\u5883\u662f\u62a5\u9519\u7684\uff0c\u539f\u56e0\u662f\u672c\u5730\u5f00\u53d1\u73af\u5883\u5728\u8c03\u7528 mount \u65b9\u6cd5\u65f6\u6ca1\u6709\u4f20\u9012\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff0c\u9ed8\u8ba4\u503c\u5c31\u662f undefined, mount \u65b9\u6cd5\u5185\u90e8\u8bd5\u56fe\u4ece undefined \u4e2d\u89e3\u6784 onNavigate\uff0c\u6240\u4ee5\u5c31\u62a5\u9519\u4e86\u3002\u89e3\u51b3\u529e\u6cd5\u662f\u5728\u672c\u5730\u5f00\u53d1\u73af\u5883\u8c03\u7528mount \u65b9\u6cd5\u65f6\u4f20\u9012\u4e00\u4e2a\u7a7a\u5bf9\u8c61\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'if (process.env.NODE_ENV === "development") {\n  // ...\n  if (el)\n    mount(el, {});\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u5982\u679c\u5f53\u524d\u4e3a\u672c\u5730\u5f00\u53d1\u73af\u5883\uff0c\u8def\u7531\u4f9d\u7136\u4f7f\u7528 BrowserHistory\uff0c\u6240\u4ee5\u5728\u8c03\u7528 mount \u65b9\u6cd5\u65f6\u4f20\u9012 defaultHistory \u4ee5\u505a\u533a\u5206\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'// Marketing/bootstrap.js\nif (process.env.NODE_ENV === "development") {\n  // ...\n  if (el)\n    mount(el, {\n      defaultHistory: createBrowserHistory(),\n    });\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u5728 mount \u65b9\u6cd5\u5185\u90e8\u5224\u65ad defaultHistory \u662f\u5426\u5b58\u5728\uff0c\u5982\u679c\u5b58\u5728\u5c31\u7528 defaultHistory\uff0c\u5426\u5219\u5c31\u7528MemoryHistory\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:"// Marketing/bootstrap.js\nfunction mount(el, { onNavigate, defaultHistory }) {\n  const history = defaultHistory || createMemoryHistory()\n}\n"})}),"\n",(0,t.jsx)(e.h3,{id:"authentication",children:"Authentication"}),"\n",(0,t.jsx)(e.h4,{id:"\u5e94\u7528\u521d\u59cb\u5316-2",children:"\u5e94\u7528\u521d\u59cb\u5316"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"1. \u62f7\u8d1d src \u6587\u4ef6\u5939\u5e76\u505a\u5982\u4e0b\u4fee\u6539"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'// bootstrap.js\nif (process.env.NODE_ENV === "development") { \n  const el = document.querySelector("#dev-auth")\n}\n'})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:' \n// App.js\nimport React from "react"\nimport { Router, Route, Switch } from "react-router-dom"\nexport default function App({ history }) {\n  return (\n    <Router history={history}>\n      <Switch>\n        <Route path="/auth/signin" component={Signin}></Route>\n      </Switch>\n\t\t</Router>\n\t) \n}\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"2. \u62f7\u8d1d public \u6587\u4ef6\u5939\uff0c\u5e76\u4fee\u6539 index.html"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-html",children:'<div id="dev-auth"></div>\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"3. \u62f7\u8d1d webpack.config.js \u6587\u4ef6\u5e76\u8fdb\u884c\u4fee\u6539"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'module.exports = { \n  devServer: {\n\t\tport: 8082 \n  },\n  plugins: [\n    new ModuleFederationPlugin({\n      name: "auth",\n      exposes: {\n\t\t\t\t"./AuthApp": "./src/bootstrap" \n      }\n\t\t}) \n  ]\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"4. \u6dfb\u52a0\u5e94\u7528\u542f\u52a8\u547d\u4ee4"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-json",children:'// package.json\n"scripts": {\n  "start": "webpack serve"\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"5. \u4fee\u6539 publicPath \u66f4\u6b63\u6587\u4ef6\u7684\u8bbf\u95ee\u8def\u5f84"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'// webpack.config.js\nmodule.exports = { \n  output: {\n    publicPath: "http://localhost:8082/"\n  }\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"6. \u66f4\u6b63\u5176\u4ed6\u5fae\u5e94\u7528\u7684 publicPath"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'// Container/webpack.config.js\noutput: {\n  publicPath: "http://localhost:8080/"\n}\n'})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'// Marketing/webpack.config.js\noutput: {\n  publicPath: "http://localhost:8081/"\n}\n'})}),"\n",(0,t.jsx)(e.h4,{id:"container-\u5e94\u7528\u52a0\u8f7d-authapp",children:"Container \u5e94\u7528\u52a0\u8f7d AuthApp"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"1. \u5728 Container \u5e94\u7528\u7684 webpack \u4e2d\u914d\u7f6e\u6dfb\u52a0 AuthApp \u7684\u8fdc\u7aef\u5730\u5740"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'// Container/webpack.config.js\nremotes: {\n\tauth: "auth@http://localhost:8082/remoteEntry.js"\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"2. \u5728 Container \u5e94\u7528\u7684 components \u6587\u4ef6\u5939\u4e2d\u65b0\u5efa AuthApp.js\uff0c\u5e76\u62f7\u8d1d MarketingApp.js \u4e2d\u7684\u5185\u5bb9\u8fdb\u884c\u4fee\u6539"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'import { mount } from "auth/AuthApp"\nexport default function AuthApp() {}\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"3. \u5728 Container \u5e94\u7528\u7684 App.js \u6587\u4ef6\u4e2d\u914d\u7f6e\u8def\u7531"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:"<Router history={history}>\n  <Header />\n\t<Switch>\n  <Route path='/auth/signin'>\n    <AuthApp setStatus={setStatus} />\n  </Route>\n\t<Route path='/'>\n  \t<MarketingApp />\n  </Route>\n\t</Switch>\n</Router>\n"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"4. \u89e3\u51b3\u767b\u5f55\u9875\u9762\u70b9\u51fb\u4e24\u6b21\u624d\u663e\u793a\u7684 Bug"})}),"\n",(0,t.jsx)(e.p,{children:"\u5f53\u70b9\u51fb\u767b\u5f55\u6309\u94ae\u65f6\uff0c\u5bb9\u5668\u5e94\u7528\u7684\u8def\u7531\u5730\u5740\u662f /auth/signin\uff0c\u52a0\u8f7d AuthApp\uff0c\u4f46\u662f AuthApp \u5728\u9996\u6b21\u52a0\u8f7d\u65f6\u9ed8\u8ba4\u8bbf\u95ee\u7684\u662f /\uff0c\u56e0\u4e3a\u5728\u4f7f\u7528 createMemoryHistory \u521b\u5efa\u8def\u7531\u65f6\u6ca1\u6709\u4f20\u9012\u521d\u59cb\u53c2\u6570\uff0c\u5f53\u518d\u6b21\u70b9\u51fb\u767b\u5f55\u6309\u94ae\u65f6\uff0c\u5bb9\u5668\u5e94\u7528\u901a\u77e5\u5fae\u5e94\u7528\u8def\u7531\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u5fae\u5e94\u7528\u540c\u6b65\u8def\u7531\u53d8\u5316\uff0c\u6240\u4ee5\u6700\u7ec8\u770b\u5230\u4e86\u767b\u5f55\u9875\u9762\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u89e3\u51b3\u95ee\u9898\u7684\u6838\u5fc3\u70b9\u5728\u4e8e\u5fae\u5e94\u7528\u5728\u521d\u59cb\u521b\u5efa\u8def\u7531\u5bf9\u8c61\u65f6\u5e94\u8be5\u63a5\u6536\u4e00\u4e2a\u9ed8\u8ba4\u53c2\u6570\uff0c\u9ed8\u8ba4\u53c2\u6570\u5c31\u6765\u81ea\u4e8e\u5bb9 \u5668\u5e94\u7528\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:"// auth/bootstrap.js\nfunction mount(el, { onNavigate, defaultHistory, initialPath }) {\n  createMemoryHistory({\n    initialEntries: [initialPath]\n  })\n}\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:"// container/src/components/AuthApp.js\nmount(ref.current, {\n\tinitialPath: history.location.pathname\n})\n"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"5. \u6309\u7167\u4e0a\u8ff0\u65b9\u6cd5\u4fee\u6b63 MarketingApp"})}),"\n",(0,t.jsx)(e.h3,{id:"\u61d2\u52a0\u8f7d\u5fae\u5e94\u7528",children:"\u61d2\u52a0\u8f7d\u5fae\u5e94\u7528"}),"\n",(0,t.jsx)(e.p,{children:"\u76ee\u524d\u6240\u6709\u7684\u5fae\u5e94\u7528\u90fd\u4f1a\u5728\u7528\u6237\u521d\u59cb\u8bbf\u95ee\u65f6\u88ab\u52a0\u8f7d\uff0c\u8fd9\u6837\u4f1a\u5bfc\u81f4\u52a0\u8f7d\u65f6\u95f4\u8fc7\u957f\uff0c\u89e3\u51b3\u529e\u6cd5\u5c31\u662f\u61d2\u52a0\u8f7d\u5fae\u5e94\u7528\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'import React, { lazy, Suspense, useState, useEffect } from "react";\nimport { Router, Route, Switch, Redirect } from "react-router-dom";\nimport Progress from "./components/Progress";\n\nconst MarketingApp = lazy(() => import("./components/MarketingApp"));\nconst AuthApp = lazy(() => import("./components/AuthApp"));\n\nfunction App() {\n  return (\n    <Router history={history}>\n      <Suspense fallback={<Progress />}>\n        <Switch>\n          <Route path=\'/auth/signin\'>\n            <AuthApp setStatus={setStatus} />\n          </Route>\n          <Route path=\'/\'>\n            <MarketingApp />\n          </Route>\n        </Switch>\n      </Suspense>\n    </Router>\n  );\n}\n\nexport default App;\n'})}),"\n",(0,t.jsx)(e.h3,{id:"\u767b\u5f55\u72b6\u6001",children:"\u767b\u5f55\u72b6\u6001"}),"\n",(0,t.jsx)(e.h4,{id:"\u8bbe\u7f6e\u767b\u5f55\u72b6\u6001",children:"\u8bbe\u7f6e\u767b\u5f55\u72b6\u6001"}),"\n",(0,t.jsx)(e.p,{children:"\u7531\u4e8e\u6bcf\u4e2a\u5fae\u5e94\u7528\u90fd\u6709\u53ef\u80fd\u7528\u5230\u767b\u5f55\u72b6\u6001\u4ee5\u53ca\u8bbe\u7f6e\u767b\u5f55\u72b6\u6001\u7684\u65b9\u6cd5\uff0c\u6240\u4ee5\u767b\u5f55\u72b6\u6001\u548c\u8bbe\u7f6e\u767b\u5f55\u72b6\u6001\u7684\u65b9\u6cd5\u9700\u8981\u653e\u7f6e\u5728\u5bb9\u5668\u5e94\u7528\u4e2d\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:"// Container/App.js\nexport default function App() {\n  // \u5b58\u50a8\u767b\u5f55\u72b6\u6001\n  const [status, setStatus] = useState(false) \n  return <AuthApp setStatus={setStatus} />\n}\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:"// Container/AuthApp.js\nexport default function AuthApp({ setStatus }) {\n  useEffect(() => {\n\t\tmount(ref.current, { setStatus }) \n  }, [])\n}\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:"// Auth/bootstrap.js\nfunction mount(el, { setStatus }) { \n  ReactDOM.render(<App setStatus={setStatus} />, el)\n}\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:"// Auth/App.js\nexport default function App({ setStatus }) {\n  return <Signin setStatus={setStatus} />\n}\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:"// Auth/Signin.js\nexport default function SignIn({ setStatus }) {\n\treturn <Button onClick={() => setStatus(true)}>\u767b\u5f55</Button>\n}\n"})}),"\n",(0,t.jsx)(e.h4,{id:"\u767b\u5f55\u72b6\u6001\u5e94\u7528",children:"\u767b\u5f55\u72b6\u6001\u5e94\u7528"}),"\n",(0,t.jsxs)(e.p,{children:["\u6839\u636e\u767b\u5f55\u72b6\u6001\u66f4\u6539\u5934\u90e8\u7ec4\u4ef6\u53f3\u4fa7\u7684\u6309\u94ae\u6587\u5b57\uff0c\u5982\u679c\u662f",(0,t.jsx)(e.strong,{children:"\u672a\u767b\u5f55\u72b6\u6001"}),"\uff0c",(0,t.jsx)(e.strong,{children:"\u663e\u793a\u767b\u5f55"}),"\uff0c\u5982\u679c\u662f",(0,t.jsx)(e.strong,{children:"\u767b\u5f55\u72b6\u6001"}),"\uff0c\u663e\u793a\u9000\u51fa\u3002\u70b9\u51fb\u9000\u51fa\u6309\u94ae\u53d6\u6d88\u767b\u5f55\u72b6\u6001\u3002 \u5982\u679c\u767b\u5f55\u72b6\u6001\u4e3a\u771f\uff0c\u8df3\u8f6c\u5230 Dashboard \u5e94\u7528\u3002"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'// Container/App.js\nexport default function App() {\n  const [status, setStatus] = useState(false) \n  // \u5982\u679c\u767b\u5f55\u72b6\u6001\u4e3a\u771f\uff0c\u8df3\u8f6c\u5230 Dashboard \u5e94\u7528 \n  useEffect(() => {\n  \tif (status) history.push("/dashboard") \n  }, [status])\n  return (\n    <Router history={history}>\n      {/* \u5c06\u767b\u5f55\u72b6\u6001\u548c\u8bbe\u7f6e\u767b\u5f55\u72b6\u6001\u7684\u65b9\u6cd5\u4f20\u9012\u5230\u5934\u90e8\u7ec4\u4ef6 */} \n      <Header status={status} setStatus={setStatus} />\n    </Router>\n  ) \n}\n'})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'// Container/Header.js\nexport default function Header({ status, setStatus }) { \n  // \u5f53\u70b9\u51fb\u6309\u94ae\u65f6\u53d6\u6d88\u767b\u5f55\u72b6\u6001\n\tconst onClick = () => {\n    if (status && setStatus) setStatus(false)\n  }\nreturn <Button \n  to={status ? "/" : "/auth/signin"} \n  onClick={onClick}\n  >{status ? "\u9000\u51fa" : "\u767b\u5f55"}</Button>\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"dashboard",children:"Dashboard"}),"\n",(0,t.jsx)(e.h4,{id:"\u521d\u59cb\u5316",children:"\u521d\u59cb\u5316"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"1. \u65b0\u5efa public \u6587\u4ef6\u5939\u5e76\u62f7\u8d1d index.html \u6587\u4ef6"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-html",children:'<div id="dev-dashboard"></div>\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"2. \u65b0\u5efa src \u6587\u4ef6\u5939\u5e76\u62f7\u8d1d index.js \u548c bootstrap.js"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'// bootstrap.js\nimport { createApp } from "vue"\nimport Dashboard from "./components/Dashboard.vue"\nfunction mount(el) {\n  const app = createApp(Dashboard) \n  app.mount(el)\n}\nif (process.env.NODE_ENV === "development") {\n\tconst el = document.querySelector("#dev-dashboard") \n  if (el) mount(el)\n}\nexport { mount }\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"3. \u62f7\u8d1d webpack.config.js \u6587\u4ef6\u5e76\u505a\u5982\u4e0b\u4fee\u6539"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'const HtmlWebpackPlugin = require("html-webpack-plugin")\nconst { VueLoaderPlugin } = require("vue-loader")\nconst ModuleFederationPlugin = require("webpack/lib/container/ModuleFederationPlugin")\nconst packageJson = require("./package.json")\n\nmodule.exports = {\n  mode: "development",\n  entry: "./src/index.js",\n  output: {\n    publicPath: "http://localhost:8083/",\n    filename: "[name].[contentHash].js"\n  },\n  resolve: {\n    extensions: [".js", ".vue"]\n  },\n  devServer: {\n    port: 8083,\n    historyApiFallback: true,\n    headers: {\n      "Access-Control-Allow-Origin": "*"\n    }\n  },\n  module: {\n    rules: [\n      {\n        test: /\\.(png|jpe?g|gif|woff|svg|eot|ttf)$/i,\n        use: [\n          {\n            loader: "file-loader"\n          }\n        ]\n      },\n      {\n        test: /\\.vue$/,\n        use: "vue-loader"\n      },\n      {\n        test: /\\.scss|\\.css$/,\n        use: ["vue-style-loader", "style-loader", "css-loader", "sass-loader"]\n      },\n      {\n        test: /\\.js$/,\n        exclude: /node_modules/,\n        use: {\n          loader: "babel-loader",\n          options: {\n            presets: ["@babel/preset-env"],\n            plugins: ["@babel/plugin-transform-runtime"]\n          }\n        }\n      }\n    ]\n  },\n  plugins: [\n    new ModuleFederationPlugin({\n      name: "dashboard",\n      filename: "remoteEntry.js",\n      exposes: {\n        "./DashboardApp": "./src/bootstrap"\n      },\n      shared: packageJson.dependencies\n    }),\n    new HtmlWebpackPlugin({\n      template: "./public/index.html"\n    }),\n    new VueLoaderPlugin()\n  ]\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"4. \u4fee\u6539\u542f\u52a8\u547d\u4ee4"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'"scripts": {\n  "start": "webpack serve"\n}\n'})}),"\n",(0,t.jsx)(e.h4,{id:"container-\u5e94\u7528\u52a0\u8f7d-dashboard",children:"Container \u5e94\u7528\u52a0\u8f7d Dashboard"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"1. Container \u914d\u7f6e ModuleFedaration"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'// container/webpack.config.js\nremotes: {\n\tdashboard: "dashboard@http://localhost:8083/remoteEntry.js"\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"2. \u65b0\u5efa DashboardApp \u7ec4\u4ef6"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'import React, { useRef, useEffect } from "react"\nimport { mount } from "dashboard/DashboardApp"\nexport default function DashboardApp() {\n  const ref = useRef()\n  useEffect(() => {\n\t\tmount(ref.current) \n  }, [])\n  return <div ref={ref}></div>\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"3. Container \u5e94\u7528\u6dfb\u52a0\u8def\u7531"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'const DashboardApp = lazy(() => import("./components/DashboardApp"))\nfunction App () {\n  return (\n    <Route path="/dashboard">\n      <DashboardApp />\n\t\t</Route>\n) }\n'})}),"\n",(0,t.jsx)(e.h4,{id:"dashboard-\u8def\u7531\u4fdd\u62a4",children:"Dashboard \u8def\u7531\u4fdd\u62a4"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'function App () {\n  const [status, setStatus] = useState(false)\n  useEffect(() => {\n\t\tif (status) history.push("/dashboard") \n  }, [status])\n\treturn (\n    <Router history={history}>\n      <Route path="/dashboard">\n        {!status && <Redirect to="/" />}\n        <DashboardApp />\n      </Route>\n\t\t</Router>\n\t) \n}\n'})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:' // Marketing/Landing.js\n<Link to="/dashboard">\n  <Button variant="contained" color="primary">\n\t\tDashboard\n  </Button>\n</Link>\n'})})]})}function p(n={}){const{wrapper:e}={...(0,s.a)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(d,{...n})}):d(n)}},1151:(n,e,r)=>{r.d(e,{Z:()=>i,a:()=>a});var t=r(7294);const s={},o=t.createContext(s);function a(n){const e=t.useContext(o);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:a(n.components),t.createElement(o.Provider,{value:e},n.children)}}}]);